<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Extended Data Processing</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">My Project<span id="projectnumber">&#160;1</span>
   </div>
   <div id="projectbrief">Yet another Wii Balance Board Driver</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Extended Data Processing</div></div>
</div><!--header-->
<div class="contents">

<p>Functions for interpreting and displaying Wii Balance Board data.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga8a70b74d08e64dcfd5a6b1e289e2ef08"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ExtendedProcessing.html#ga8a70b74d08e64dcfd5a6b1e289e2ef08">process_calibration_data</a> (int *bytes_read, unsigned char *<a class="el" href="YAWiiBBessentials_8h.html#acab2203504e72e5e674d3174e0bd7d5e">buffer</a>, <a class="el" href="structWiiBalanceBoard.html">WiiBalanceBoard</a> *board)</td></tr>
<tr class="memdesc:ga8a70b74d08e64dcfd5a6b1e289e2ef08"><td class="mdescLeft">&#160;</td><td class="mdescRight">Processes the calibration data from the Wii Balance Board.  <a href="group__ExtendedProcessing.html#ga8a70b74d08e64dcfd5a6b1e289e2ef08">More...</a><br /></td></tr>
<tr class="separator:ga8a70b74d08e64dcfd5a6b1e289e2ef08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad302657f1801e9590f4a7f454818b734"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ExtendedProcessing.html#gad302657f1801e9590f4a7f454818b734">bytes_to_int_big_endian</a> (const unsigned char *<a class="el" href="YAWiiBBessentials_8h.html#acab2203504e72e5e674d3174e0bd7d5e">buffer</a>, size_t position, int *max)</td></tr>
<tr class="memdesc:gad302657f1801e9590f4a7f454818b734"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts two consecutive bytes in the buffer from Big-Endian representation to a decimal integer.  <a href="group__ExtendedProcessing.html#gad302657f1801e9590f4a7f454818b734">More...</a><br /></td></tr>
<tr class="separator:gad302657f1801e9590f4a7f454818b734"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga05333867b38c4e18d7af195b85ac4480"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ExtendedProcessing.html#ga05333867b38c4e18d7af195b85ac4480">calc_mass</a> (const <a class="el" href="structWiiBalanceBoard.html">WiiBalanceBoard</a> *board, uint16_t raw, int pos)</td></tr>
<tr class="memdesc:ga05333867b38c4e18d7af195b85ac4480"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the weight in grams from the raw data of the Wii Balance Board.  <a href="group__ExtendedProcessing.html#ga05333867b38c4e18d7af195b85ac4480">More...</a><br /></td></tr>
<tr class="separator:ga05333867b38c4e18d7af195b85ac4480"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5ca10c6c473e8539e765ed4cce662b01"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ExtendedProcessing.html#ga5ca10c6c473e8539e765ed4cce662b01">print_calibration_data</a> (const <a class="el" href="structWiiBalanceBoard.html">WiiBalanceBoard</a> *board)</td></tr>
<tr class="memdesc:ga5ca10c6c473e8539e765ed4cce662b01"><td class="mdescLeft">&#160;</td><td class="mdescRight">Displays the stored calibration data.  <a href="group__ExtendedProcessing.html#ga5ca10c6c473e8539e765ed4cce662b01">More...</a><br /></td></tr>
<tr class="separator:ga5ca10c6c473e8539e765ed4cce662b01"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p >Functions for interpreting and displaying Wii Balance Board data. </p>
<p >These functions provide additional capabilities for interpreting and converting raw data from the Wii Balance Board into a human-readable format. While not essential for the primary operation, they enable a deeper understanding of data processing and assist in debugging.</p>
<p >Currently, these functions accept variables in some cases, though the goal is to refactor them to exclusively use pointers where possible to streamline memory management and improve efficiency. Additionally, they would ideally be organized in a separate file, but due to challenges in managing memory access and avoiding segmentation faults, they remain integrated within this file for now.</p>
<p >To activate these extended features, compile with the <code>YAWIIBB_EXTENDED</code> flag. </p><div class="fragment"><div class="line">gcc -DYAWIIBB_EXTENDED -Wall -o complex YAWiiBBD.c YAWiiBBessentials.c -lbluetooth</div>
</div><!-- fragment --> <h2 class="groupheader">Function Documentation</h2>
<a id="gad302657f1801e9590f4a7f454818b734" name="gad302657f1801e9590f4a7f454818b734"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad302657f1801e9590f4a7f454818b734">&#9670;&nbsp;</a></span>bytes_to_int_big_endian()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t bytes_to_int_big_endian </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>position</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>max</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts two consecutive bytes in the buffer from Big-Endian representation to a decimal integer. </p>
<p >Interprets two bytes in the given <code>buffer</code> starting from the provided <code>position</code> as a 16-bit integer in Big-Endian format (most significant byte first). The function returns this integer so that it can be output in decimal form.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buffer</td><td>Pointer to the buffer that contains the bytes. </td></tr>
    <tr><td class="paramname">position</td><td>The starting position of the most significant byte in the buffer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint16_t The Big-Endian number interpreted as a decimal integer. </dd></dl>

</div>
</div>
<a id="ga05333867b38c4e18d7af195b85ac4480" name="ga05333867b38c4e18d7af195b85ac4480"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga05333867b38c4e18d7af195b85ac4480">&#9670;&nbsp;</a></span>calc_mass()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t calc_mass </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structWiiBalanceBoard.html">WiiBalanceBoard</a> *&#160;</td>
          <td class="paramname"><em>board</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>raw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the weight in grams from the raw data of the Wii Balance Board. </p>
<p >This function uses calibration data from the Wii Balance Board to calculate a weight in grams based on the given raw data. The weight is interpolated within four calibration ranges or, if the value exceeds the highest calibration range, is linearly extrapolated.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">board</td><td>A constant pointer to the Wii Balance Board structure that contains the calibration data. </td></tr>
    <tr><td class="paramname">raw</td><td>The raw data value representing the weight, measured from one of the four sensor positions (Top-Right, Bottom-Right, etc.). </td></tr>
    <tr><td class="paramname">pos</td><td>The position of the sensor (0 to 3) for the calibration data of the raw value. Must be within the range [0, 3].</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The calculated weight in grams as <code>uint16_t</code>.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>The function can interpolate weights up to 34 kg with the given calibration values. For values above this range, the weight is linearly extrapolated.</dd></dl>
<p>The calculation uses four cases based on the raw data:</p><ul>
<li>If the raw value is less than the calibration for 0 kg, 0 g is returned.</li>
<li>If the raw value is between the calibrations for 0 kg and 17 kg, linear interpolation occurs between these points.</li>
<li>If the raw value is between the calibrations for 17 kg and 34 kg, interpolation occurs within this range.</li>
<li>If the raw value is greater than or equal to the calibration for 34 kg, linear extrapolation is performed based on the last range. </li>
</ul>

</div>
</div>
<a id="ga5ca10c6c473e8539e765ed4cce662b01" name="ga5ca10c6c473e8539e765ed4cce662b01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5ca10c6c473e8539e765ed4cce662b01">&#9670;&nbsp;</a></span>print_calibration_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void print_calibration_data </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structWiiBalanceBoard.html">WiiBalanceBoard</a> *&#160;</td>
          <td class="paramname"><em>board</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Displays the stored calibration data. </p>
<p >This function is solely for debugging purposes and is no longer used. If one wants to know whether the calibration data has been stored, they can implement it. </p>

</div>
</div>
<a id="ga8a70b74d08e64dcfd5a6b1e289e2ef08" name="ga8a70b74d08e64dcfd5a6b1e289e2ef08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8a70b74d08e64dcfd5a6b1e289e2ef08">&#9670;&nbsp;</a></span>process_calibration_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void process_calibration_data </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>bytes_read</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structWiiBalanceBoard.html">WiiBalanceBoard</a> *&#160;</td>
          <td class="paramname"><em>board</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Processes the calibration data from the Wii Balance Board. </p>
<p >This function analyzes a data buffer with calibration information and extracts this into the calibration array of the passed <code><a class="el" href="structWiiBalanceBoard.html" title="Represents the Wii Balance Board connection and status.">WiiBalanceBoard</a></code> instance. The calibration data are 16-bit values stored in a big-endian format and consist of 4 pairs for each of the four corners (topright, topleft, bottomright, bottomleft).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bytes_read</td><td>Number of bytes actually read in the buffer. </td></tr>
    <tr><td class="paramname">buffer</td><td>Pointer to a buffer containing the received bytes. The expected structure is:<ul>
<li>Bytes 7-14: Calibration set 0 (4 pairs, 8 bytes)</li>
<li>Bytes 15-22: Calibration set 1 (4 pairs, 8 bytes)</li>
<li>If Byte 15 == 0x00:<ul>
<li>Bytes 7-14: Calibration set 1</li>
<li>Bytes 15-22: Calibration set 2 </li>
</ul>
</li>
</ul>
</td></tr>
    <tr><td class="paramname">board</td><td>Pointer to the <code><a class="el" href="structWiiBalanceBoard.html" title="Represents the Wii Balance Board connection and status.">WiiBalanceBoard</a></code> instance where calibration data will be stored.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function assumes that the <code>buffer</code> contains at least 23 bytes in order to process the expected calibration data.</dd></dl>
<p>The operation of the function is as follows:</p><ol type="1">
<li>Check if the second calibration packet has been received (Byte 15 == 0x00).</li>
<li>If the second packet is not present:<ul>
<li>Bytes 7-14 are stored in <code>calibration[0]</code> (Calibration set 0).</li>
<li>Bytes 15-22 are stored in <code>calibration[1]</code> (Calibration set 1).</li>
</ul>
</li>
<li>If the second packet is present:<ul>
<li>Bytes 7-14 are stored in <code>calibration[2]</code> (Calibration set 2).</li>
</ul>
</li>
</ol>
<p >Example:</p><ul>
<li>Received data as an example:<ul>
<li>buffer[7] = 0x01, buffer[8] = 0x02 (Calibration 0, Pair 0) In this case, the function would store the values in <code>board-&gt;calibration[0][0]</code></li>
<li>buffer[15] = 0x00 (indicates that this is packet 2) In this case, the function would only read bytes 7-8,[..],13-14 and store them in <code>board-&gt;calibration[2][i]</code> </li>
</ul>
</li>
</ul>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
